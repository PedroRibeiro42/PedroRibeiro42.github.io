<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>[PII040] Dracarys!</title>
    <style>
      .function {
          color: black;
          background: #ffe2e2;
          margin: 2px;
          padding: 2px;
          border: 1px dashed black;
      }
    </style>
  </head>

<body bgcolor="white">

<p><small>In what concerns the continuous evaluation solving exercises grade during the semester, you should </small><b><span style="color:green">submit until 23:59 of April 7th</span></b><br>
  <small><i>(this exercise will still be available for submission after that deadline, but without couting towards your grade)</i><br>
    <b>[to understand the context of this problem, you should read the <a target="_blank" href="https://www.dcc.fc.up.pt/~pribeiro/aulas/pii2425/practical/class05.html">class #05 exercise sheet</a>]</b></small></p>

<hr>

<p style="color:red"><b>In this problem you should submit a file containing the function as described (<u>without any main function</u>). Inside the function do not print anything that was not asked! </b></p>

<h2>[PII040] Dracarys!</h2>

<p><img src="pii040.png" align="right" width="200">
  In the blazing heat of Dragonstone, Daenerys Targaryen, the Mother of Dragons, prepares for the wars to come. She is aware of how the Free Folks words evolve (from [PII039], the last problem), and has tasked you with a perilous challenge.</p>
  
<p><i>"When words grow like fire, finding one letter may change everything. I need you to tell me the k-th letter after these words evolve â€” quickly! Fail me, and you will face the wrath of my dragons!"</i></p>

<p>Can can solve this puzzle efficiently? Failure to do so will result in her commanding Drogon, Rhaegal and Viserion to unleash Dracarys, engulfing you on dragon fire.</p>
  
<h3>The Problem</h3>

<p>Write a function <span class="function">char which_one(long n)</span> that, given an integer <b>n</b>, returns the <i>n</i>-th letter (the one in position <i>n</i>) that appears on a word evolving with the Free Folk rules when starting with <i>"A"</i>. Recall the rules of the game:</p>

<ul>
  <li>Any 'A' becomes 'AB'
  <li>Any 'B' becomes 'A'
</ul>

<p>The first lines of the word are therefore:</p>

<pre>
A
AB
ABA
ABAAB
ABAABABA
ABAABABAABAAB
ABAABABAABAABABAABABA
</pre>

<p>You can see that the initial part of any generation is the same as the previous, so you really don't need to know the generation and knowing the position is enough, right?</p>

<h3>Constraints</h3>

<p>The following limits are guaranteed in all the test cases that will be given to your program:</p>

<table>
  <tr>
    <td>1 &le; <b>n</b> &le; 10<sup>16</sup></td>
    <td>&nbsp; &nbsp; &nbsp;</td>
    <td>Position of the letter to find</td>
  </tr>  
</table>

<h3>Submission</h3>

<p>You should submit a <code>.c</code> file containing the requested function, without any main function and without printing anything. You can however create additional methods, if you need them.</p>

<p>Mooshak will use the following code to link to your function, read the inputs and call your method, printing its result.</p>

<pre style="border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-family:monospace;color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-weight: 400; "><span style="color: rgb(0, 92, 197); font-weight: 400;">#<span style="color: rgb(215, 58, 73); font-weight: 400;">include</span> <span style="color: rgb(3, 47, 98); font-weight: 400;">&lt;stdio.h&gt;</span></span>
<span style="color: rgb(0, 92, 197); font-weight: 400;">#<span style="color: rgb(215, 58, 73); font-weight: 400;">include</span> <span style="color: rgb(3, 47, 98); font-weight: 400;">&lt;string.h&gt;</span></span>

<span style="color: rgb(0, 92, 197); font-weight: 400;">#<span style="color: rgb(215, 58, 73); font-weight: 400;">define</span> MAX_SIZE 100</span>

<span style="color: rgb(215, 58, 73); font-weight: 400;">char</span> <span style="color: rgb(111, 66, 193); font-weight: 400;">which_one</span><span style="color: rgb(36, 41, 46); font-weight: 400;">(<span style="color: rgb(215, 58, 73); font-weight: 400;">long</span>)</span>;

<span style="color: rgb(215, 58, 73); font-weight: 400;">int</span> <span style="color: rgb(111, 66, 193); font-weight: 400;">main</span><span style="color: rgb(36, 41, 46); font-weight: 400;">(<span style="color: rgb(215, 58, 73); font-weight: 400;">void</span>)</span> {

  <span style="color: rgb(106, 115, 125); font-weight: 400;">// Read amount of test cases</span>
  <span style="color: rgb(215, 58, 73); font-weight: 400;">int</span> k;
  <span style="color: rgb(227, 98, 9); font-weight: 400;">scanf</span>(<span style="color: rgb(3, 47, 98); font-weight: 400;">"%d"</span>, &amp;k);

  <span style="color: rgb(106, 115, 125); font-weight: 400;">// Read n cases and for each call the which_one function</span>
  <span style="color: rgb(215, 58, 73); font-weight: 400;">for</span> (<span style="color: rgb(215, 58, 73); font-weight: 400;">int</span> i=<span style="color: rgb(0, 92, 197); font-weight: 400;">0</span>; i&lt;k; i++) {
    <span style="color: rgb(215, 58, 73); font-weight: 400;">long</span> n;
    <span style="color: rgb(227, 98, 9); font-weight: 400;">scanf</span>(<span style="color: rgb(3, 47, 98); font-weight: 400;">"%ld"</span>, &amp;n);
    <span style="color: rgb(227, 98, 9); font-weight: 400;">printf</span>(<span style="color: rgb(3, 47, 98); font-weight: 400;">"which_one(%ld) = %c\n"</span>, n, which_one(n));
  }
  
  <span style="color: rgb(215, 58, 73); font-weight: 400;">return</span> <span style="color: rgb(0, 92, 197); font-weight: 400;">0</span>; 
}
</pre>

<p style="color:red">NOTE: the limits are really high and you must have an <b>efficient</b> (in space and memory) solution that can compute this very quickly.<br>
  The entire word will not fit on the memory of a personal computer and even if it did, a solution that simply tries to simulate the evolution and recreate the entire word up to <i>n</i> would most likely have <b>Time Limit Exceeded</b>.<br>
  Your program will need to be able to answer around 500 queries in less than one second.</p>

<br>

<table cellspacing="1" cellpadding="4" bgcolor="black" border="0">
  <tr bgcolor="#e2e2e2">
    <td>Example Input</td>
    <td>Example Output</td>
  </tr>
  <tr bgcolor="white">
    <td valign="top">
<pre>
7
1
2
3
4
5
10
16
</pre>
    </td>
    <td valign="top">
<pre>
which_one(1) = A
which_one(2) = B
which_one(3) = A
which_one(4) = A
which_one(5) = B
which_one(10) = B
which_one(16) = A
</pre>

    </td>
  </tr>
</table>
    
<hr size="2">
<center><b>Programming II (CCINF1002)</b><br>
  DCC/FCUP - University of Porto
</center>
<hr size="2">

</body></html>
